根据北京大学随机过程课件（尤其是 `第-2-章-第-1-讲_随机游动 例子作业.pdf` 和 `第-2-章-第-3-讲-马尔可夫状态分析.pdf`），迟早返回原点（Eventually Return）的概率计算主要依赖于概率母函数（Generating Function）以及马尔可夫链的常返性判别准则。

以下是具体的计算方法总结：

## 1. 定义与符号

- $v_{n}$（或 $f_{00}^{(n)}$）：表示从原点出发，恰好在第 $n$ 步第一次返回原点的概率。
- $P$（或 $f_{00}$）：表示迟早返回原点的总概率。

计算公式为所有第一次返回概率之和：

$$P = \sum_{n=1}^{\infty} v_n$$

- $u_{n}$（或 $p_{00}^{(n)}$）：表示第 $n$ 步处于原点的概率（不一定是第一次）。

## 2. 计算方法一：利用母函数（Generating Function）——最常用的解析法

这是课件中推导 $P$ 的核心方法。

### （1）定义母函数

- 设 $u_n$ 的母函数为 $U(z) = \sum_{n=0}^{\infty} u_n z^n$。
- 设 $v_n$ 的母函数为 $V(z) = \sum_{n=1}^{\infty} v_n z^n$。

### （2）建立关系

利用卷积公式 $u_n = \sum_{k=1}^{n} v_k u_{n-k}$，可以推导出两者满足代数关系：

$$U(z) = 1 + U(z)V(z) \implies V(z) = 1 - \frac{1}{U(z)}$$

### （3）求解 $P$

迟早返回原点的概率 $P$ 等于第一次返回概率之和，即令 $z=1$ 时的 $V(z)$ 值：

$$P = \sum_{n=1}^{\infty} v_n = V(1)$$

代入关系式可得：

$$P = 1 - \frac{1}{U(1)} = 1 - \frac{1}{\sum_{n=0}^{\infty} u_n}$$

### （4）针对随机游走的具体计算

对于一维随机游走，第 $2n$ 步处于原点的概率为 $u_{2n} = C_{2n}^n p^n q^n$（$n$ 为奇数时为 0）。

利用泰勒展开和二项式定理，可以推导出 $V(z)$ 的显式表达式：

$$V(z) = 1 - \sqrt{1 - 4pqz^2}$$

令 $z=1$，得到迟早返回的概率：

$$P = V(1) = 1 - \sqrt{1 - 4pq} = 1 - \sqrt{(p+q)^2 - 4pq} = 1 - \sqrt{(p-q)^2} = 1 - |p-q|$$

## 3. 计算方法二：级数判别法（常返性准则）

这种方法主要用于判断 $P$ 是否等于 1（即是否为常返态），而不需要计算具体的级数和。

### （1）判别准则

- 如果 $\sum_{n=0}^{\infty} u_n = \infty$，则状态是常返的，即 $P = 1$。
- 如果 $\sum_{n=0}^{\infty} u_n < \infty$，则状态是非常返（滑过）的，即 $P < 1$。
- 非常返时的具体概率为：$P = 1 - \frac{1}{\sum u_n}$。

### （2）应用于随机游走

利用斯特林公式（Stling's Approximation）近似 $u_{2n}$：

$$u_{2n} \approx \frac{[4p(1-p)]^n}{\sqrt{n\pi}}$$

- 当 $p = 1/2$（对称随机游走）时：$4p(1-p)=1$，级数 $\sum \frac{1}{\sqrt{n\pi}}$ 发散（$\to \infty$）。
    - 结论：$P = 1$（必然返回）。
- 当 $p \neq 1/2$（非对称）时：$4p(1-p) < 1$，级数收敛（$< \infty$）。
    - 结论：$P < 1$（有一定概率永远不返回）。

## 4. 结论总结

| 情况 | 参数关系 | 迟早返回概率（$P$） | 状态性质 |
|:--|:--|:--|:--|
| 对称随机游走 | $p = q = 1/2$ | 1（100% 返回） | 常返（Recurrent） |
| 非对称随机游走 | $p \neq q$ | $1 - \mid p-q \mid$ | 非常返（Transient） |

注意：即使在 $p=1/2$ 的情况下（$P=1$），平均返回时间 $\mu = \sum n v_n$ 却是无穷大（$\infty$）。

---

**<font color="#2ecc71">✅ 已格式化</font>**
