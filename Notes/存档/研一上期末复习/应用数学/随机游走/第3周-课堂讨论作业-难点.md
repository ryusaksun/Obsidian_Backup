![[Pasted image 20260106214707.png]]
这道填空题考察的是随机游走模型中返回原点的概率计算。

## 题目解答

答案如下：

- 0.3456

- 0.27648

## 详细计算过程

要从原点出发，经过 $N$ 步后返回原点，必须满足一个条件：向前走的步数等于向后走的步数。

这意味着，如果总步数是 $2n$，那么必须有 $n$ 步是向前（$+1$），$n$ 步是向后（$-1$）。

利用二项分布概率公式 $P = C_{总步数}^{向前步数} \cdot p^{向前步数} \cdot q^{向后步数}$ 进行计算。

### 1. 经过 4 步之后回到原点的概率（1）

- 分析：总共走 4 步，要回到原点，必须 2 步向前，2 步向后。
- 参数：$n=4, k=2$（向前次数），$p=0.6, q=0.4$。
- 计算：

    $$P_4 = C_4^2 \cdot p^2 \cdot q^2$$

    $$P_4 = \frac{4 \times 3}{2 \times 1} \cdot (0.6)^2 \cdot (0.4)^2$$

    $$P_4 = 6 \cdot 0.36 \cdot 0.16$$

    $$P_4 = 6 \cdot 0.0576$$

    $$P_4 = 0.3456$$

### 2. 经过 6 步之后回到原点的概率（2）

- 分析：总共走 6 步，要回到原点，必须 3 步向前，3 步向后。
- 参数：$n=6, k=3$（向前次数），$p=0.6, q=0.4$。
- 计算：

    $$P_6 = C_6^3 \cdot p^3 \cdot q^3$$

    $$P_6 = \frac{6 \times 5 \times 4}{3 \times 2 \times 1} \cdot (0.6)^3 \cdot (0.4)^3$$

    $$P_6 = 20 \cdot 0.216 \cdot 0.064$$

    $$P_6 = 20 \cdot 0.013824$$

    $$P_6 = 0.27648$$

## 总结公式

对于从原点出发的一维简单随机游走，在 $2n$ 步时刻返回原点的概率公式为：

$$P_{2n} = C_{2n}^n (pq)^n$$

可以直接代入 $pq = 0.6 \times 0.4 = 0.24$ 验证：

- 4步：$6 \times (0.24)^2 = 0.3456$
- 6步：$20 \times (0.24)^3 = 0.27648$

---
![[Pasted image 20260106214719.png]]
这道题考察的是随机游走模型中的首次返回（First Return/First Passage）概率。

注意：这与上一题的返回概率不同。首次返回要求粒子在中间的过程中不能经过原点，直到最后一步才第一次回到原点。

## 题目解答

答案如下：

- 0.1152

- 0.055296

## 详细计算过程

已知参数：

- 前进概率 $p = 0.6$
- 后退概率 $q = 0.4$
- 乘积 $pq = 0.24$

### 1. 经过 4 步第一次返回原点的概率（1）

我们列举所有走 4 步回到原点的路径（共 $C_4^2=6$ 条），并筛选出符合第一次条件的：

- 路径分析：

    要回到原点，必须 2 步向前（$+），2 步向后（$-）。

    1. $+--+$（第 2 步回到原点，不符合）
    2. $-++-$（第 2 步回到原点，不符合）
    3. $+-+-$（第 2 步回到原点，不符合）
    4. $-+-+$（第 2 步回到原点，不符合）
    5. $++--$（第 2 步在位置 2，第 4 步首次回 0，符合）
    6. $--++$（第 2 步在位置 -2，第 4 步首次回 0，符合）

    符合条件的只有 2 条路径。

- 计算：

    $$P = 2 \cdot p^2 q^2$$

    $$P = 2 \cdot (0.6)^2 \cdot (0.4)^2 = 2 \cdot (0.24)^2$$

    $$P = 2 \cdot 0.0576 = 0.1152$$

### 2. 经过 6 步第一次返回原点的概率（2）

同样，我们从总共 $C_6^3=20$ 条回归路径中筛选。

根据首次返回的数学性质，路径数量与卡特兰数（Catalan Number）有关。对于 $2n$ 步的首次返回，合法路径数为 $2 \times C_{n-1}$。

这里 $n=3$（6步），所以路径数为 $2 \times C_2 = 2 \times 2 = 4$ 条。

- 路径分析（验证）：

    合法路径必须一直保持在正半轴或负半轴，直到最后一步跨回原点。

    - 正向起步（中间不能触碰0）：
        1. $+++---$
        2. $++-+--$

    - 负向起步（对称）：
        3. $---+++$
        4. $--+-++$

    符合条件的只有 4 条路径。

- 计算：

    $$P = 4 \cdot p^3 q^3$$

    $$P = 4 \cdot (0.6)^3 \cdot (0.4)^3 = 4 \cdot (0.24)^3$$

    $$P = 4 \cdot 0.013824 = 0.055296$$

## 快速公式

对于简单随机游走，第 $2n$ 步首次返回原点的概率 $f_{2n}$ 与第 $2n$ 步任意返回原点的概率 $u_{2n}$ 有如下关系：

$$f_{2n} = \frac{1}{2n-1} u_{2n}$$

验证本题：

- 4步：$u_4 = C_4^2 p^2 q^2 = 6(0.24)^2$。

    $$f_4 = \frac{1}{3} \times 6(0.24)^2 = 2(0.24)^2 = 0.1152$$

    （正确）

- 6步：$u_6 = C_6^3 p^3 q^3 = 20(0.24)^3$。

    $$f_6 = \frac{1}{5} \times 20(0.24)^3 = 4(0.24)^3 = 0.055296$$

    （正确）

---
![[Pasted image 20260106214730.png]]
这道填空题考察的是随机游走模型中的常返性（Recurrence），即从原点出发，最终是否会回来的概率问题。

## 题目解答

答案如下：

- 1

- 0.8

- 0.8

## 知识点详解

这个问题在随机过程中被称为波利亚定理（Polya's Theorem）在一维情况下的应用，或者更通俗地称为赌徒破产问题（Gambler's Ruin）的变体（无限资金版）。

我们需要计算的是 $u_{00}$，即从 0 出发最终返回 0 的概率。计算逻辑可以分解为：第一步是向左还是向右，然后从那个新位置最终回到 0 的概率。

### 1. 当 $p=q=0.5$ 时（对称随机游走）

- 情况分析：

    这是最经典的对称随机游走。虽然粒子可能会走到很远的地方，但只要时间足够长，它必然会回到原点。

- 数学结论：

    在 1 维和 2 维的对称简单随机游走中，状态是常返的（Recurrent），这意味着返回原点的概率是 100%。

- 填空（1）：1

### 2. 当 $p=0.6, q=0.4$ 时（有偏随机游走，向右漂移）

- 情况分析：

    此时 $p > q$，粒子有向右移动的趋势（Drift）。

    - 如果第一步向左走（概率 $q$）：既然总趋势是向右推，粒子很容易被推回原点。从左边-1回0的概率是 1。
    - 如果第一步向右走（概率 $p$）：粒子被推向远离原点的方向（$+\infty$）。想要逆流而上回到原点的概率只有 $q/p$。

- 计算公式：

    $$P_{return} = q \times1 + p \times (\frac{q}{p}) = q + q = 2q$$

    代入数值：$2 \times 0.4 = 0.8$。

- 填空（2）：0.8

### 3. 当 $p=0.4, q=0.6$ 时（有偏随机游走，向左漂移）

- 情况分析：

    此时 $q > p$，粒子有向左移动的趋势。这与情况（2）是完全对称的。

    - 如果第一步向右走（概率 $p$）：既然总趋势是向左推，粒子很容易被推回原点。从右边1回0的概率是 1。
    - 如果第一步向左走（概率 $q$）：粒子被推向远离原点的方向（$-\infty$）。想要逆流而上回到原点的概率只有 $p/q$。

- 计算公式：

    $$P_{return} = p \times1 + q \times (\frac{p}{q}) = p + p = 2p$$

    代入数值：$2 \times 0.4 = 0.8$。

- 填空（3）：0.8

## 总结公式

对于一维简单随机游走，从原点出发最终返回原点的概率 $P$ 为：

$$P = 1 - |p - q|$$

或者写作：

$$P = 2 \times \min(p, q)$$

- 当 $p=0.5$ 时，$P = 1 - 0 = 1$。
- 当 $p=0.6$ 时，$P = 1 - |0.6 - 0.4| = 0.8$。
- 当 $p=0.4$ 时，$P = 1 - |0.4 - 0.6| = 0.8$。

![[Pasted image 20260106214835.png]]
（1）4.8

（2）4.8

---

**<font color="#2ecc71">✅ 已格式化</font>**
