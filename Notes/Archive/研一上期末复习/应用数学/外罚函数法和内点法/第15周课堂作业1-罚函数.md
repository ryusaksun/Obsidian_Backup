![[Pasted image 20260106112945.png]]
这是一道利用外罚函数法（Exterior Penalty Function Method）求解约束优化问题的经典计算题。

这种题目的核心思想是：将约束条件转化为惩罚项加到目标函数中，从而把有约束问题转化为一系列无约束问题，最后求极限得到解。

以下是详细的求解步骤：

## 第一步：构造外罚函数

对于等式约束优化问题：

$$\min f(x) \quad \text{s.t.} \quad h(x) = 0$$

构造的罚函数形式通常为：

$$F(x, \sigma) = f(x) + \sigma [h(x)]^2$$

其中 $\sigma$ 是罚参数（充分大的正数）。

代入本题的数据：

- 目标函数：$f(x) = (x_1 - 1)^2 + (x_2 - 1)^2$

- 约束条件：$h(x) = x_1 + x_2 - 1 = 0$


构造出的增广目标函数（罚函数）为：

$$F(x_1, x_2, \sigma) = (x_1 - 1)^2 + (x_2 - 1)^2 + \sigma (x_1 + x_2 - 1)^2$$

## 第二步：求解无约束极值

对罚函数 $F$ 关于 $x_1$ 和 $x_2$ 分别求偏导，并令其为 0：

1. 对 $x_1$ 求导：

    $$\frac{\partial F}{\partial x_1} = 2(x_1 - 1) + 2\sigma(x_1 + x_2 - 1) \cdot 1 = 0$$

    化简得：

    $$(x_1 - 1) + \sigma(x_1 + x_2 - 1) = 0 \quad \text{......①}$$

2. 对 $x_2$ 求导：

    $$\frac{\partial F}{\partial x_2} = 2(x_2 - 1) + 2\sigma(x_1 + x_2 - 1) \cdot 1 = 0$$

    化简得：

    $$(x_2 - 1) + \sigma(x_1 + x_2 - 1) = 0 \quad \text{......②}$$


## 第三步：解方程组

观察方程 ① 和 ②，我们可以用 ① 减去 ②：

$$[(x_1 - 1) - (x_2 - 1)] + [\sigma(...) - \sigma(...)] = 0$$

$$x_1 - x_2 = 0 \implies x_1 = x_2$$

将 $x_2 = x_1$ 代回方程 ①：

$$(x_1 - 1) + \sigma(x_1 + x_1 - 1) = 0$$

$$x_1 - 1 + \sigma(2x_1 - 1) = 0$$

$$x_1 + 2\sigma x_1 = 1 + \sigma$$

$$x_1(1 + 2\sigma) = 1 + \sigma$$

解得含参数 $\sigma$ 的最优解：

$$x_1(\sigma) = \frac{1 + \sigma}{1 + 2\sigma}$$

同理，因为 $x_2 = x_1$，所以：

$$x_2(\sigma) = \frac{1 + \sigma}{1 + 2\sigma}$$

## 第四步：令罚参数趋于无穷大

外罚函数法的原理是，当罚参数 $\sigma \rightarrow +\infty$ 时，无约束问题的解收敛于原问题的解。

计算极限：

$$x_1^* = \lim_{\sigma \to +\infty} \frac{1 + \sigma}{1 + 2\sigma} = \lim_{\sigma \to +\infty} \frac{\sigma(1/\sigma + 1)}{\sigma(1/\sigma + 2)} = \frac{1}{2} = 0.5$$

$$x_2^* = \lim_{\sigma \to +\infty} \frac{1 + \sigma}{1 + 2\sigma} = \frac{1}{2} = 0.5$$

## 最终答案

填空处应填：

x1 = ( 0.5 ) ; x2 = ( 0.5 )

---

几何验证（帮助理解）：

这就相当于求平面上点 $(1, 1)$ 到直线 $x_1 + x_2 = 1$ 的最短距离对应的点。连接 $(1,1)$ 做直线的垂线，垂足正是 $(0.5, 0.5)$。

## 外罚函数法的原理是，当罚参数 $\sigma \rightarrow +\infty$ 时，无约束问题的解收敛于原问题的解。

这句话阐述了外罚函数法（Exterior Penalty Function Method）为什么能求出正确答案的核心数学理论依据。

我来为你通俗地解释一下它的含义：

### 1. 直观含义（通俗解释）

想象你在做一个任务（比如求极小值），但有一个严格的规则（约束条件，比如 $x_1+x_2=1$）必须遵守。

- 原问题：就像是在说你必须严格遵守规则，然后通过努力达到目标。

- 无约束问题（罚函数）：外罚函数法把这个严格规则变成了一种罚款机制。它不强制你遵守规则，但是如果你违规了，就要交罚款。

    - 罚款金额 = 违规程度 $\times$ 罚款单价 ($\sigma$)。

- $\sigma \rightarrow +\infty$：这就是说，罚款单价变得无穷大。


这句话的意思就是：

当罚款单价 ($\sigma$) 变得越来越贵（趋向于无穷大）时，为了让总成本（原目标 + 罚款）最低，你就不得不越来越严格地遵守规则。

最终，当你面对无穷大的罚款时，你算出来的那个最佳方案（无约束问题的解），就和严格遵守规则下的最佳方案（原问题的解）完全重合了。

### 2. 结合上一题来理解

回顾一下你刚才做的那个计算题：

- 无约束问题的解（带有 $\sigma$ 的解）：

    我们在第三步算出来，$x_1(\sigma) = \frac{1+\sigma}{1+2\sigma}$。

    这个解是随着 $\sigma$ 变化的。如果 $\sigma$ 很小（比如 $\sigma=1$），$x_1 = 2/3 \approx 0.67$，这其实并不等于最终答案 $0.5$，因为它为了让目标函数更小，稍微违反了一点约束条件（交了一点点罚款）。

- 极限过程 ($\sigma \rightarrow +\infty$)：

    图片里说的就是这一步操作。我们让 $\sigma$ 趋向无穷大：

    $$\lim_{\sigma \to +\infty} \frac{1+\sigma}{1+2\sigma} = 0.5$$

- 原问题的解：

    算出来的 $0.5$，正是原问题在严格满足 $x_1+x_2=1$ 时的最优解。


总结：

这张图是在告诉你为什么要计算极限。因为只有求了极限，那个带参数的中间结果才会变成最终的精确答案。

![[Pasted image 20260106114457.png]]
这是一道利用外罚函数法求解非线性等式约束优化问题的练习题。这道题与上一题非常相似，只是目标函数和约束条件变了。

以下是详细的求解步骤和最终答案：

## 第一步：构造外罚函数

- 原问题：

    - 目标函数：$f(x) = -x_1 - x_2$

    - 约束条件：$h(x) = x_1^2 + x_2^2 - 1 = 0$


- 构造罚函数：

    $$F(x, \sigma) = f(x) + \sigma [h(x)]^2$$

    $$F(x_1, x_2, \sigma) = -x_1 - x_2 + \sigma (x_1^2 + x_2^2 - 1)^2$$

    （其中 $\sigma$ 为充分大的正数）


## 第二步：求解无约束极值

对 $F$ 关于 $x_1$ 和 $x_2$ 分别求偏导，并令其为 0：

1. 对 $x_1$ 求导：

    $$\frac{\partial F}{\partial x_1} = -1 + 2\sigma(x_1^2 + x_2^2 - 1) \cdot 2x_1 = 0$$

    整理得：

    $$4\sigma x_1 (x_1^2 + x_2^2 - 1) = 1 \quad \text{......①}$$

2. 对 $x_2$ 求导：

    $$\frac{\partial F}{\partial x_2} = -1 + 2\sigma(x_1^2 + x_2^2 - 1) \cdot 2x_2 = 0$$

    整理得：

    $$4\sigma x_2 (x_1^2 + x_2^2 - 1) = 1 \quad \text{......②}$$


## 第三步：解方程组

观察方程 ① 和 ②，右边都是 1，且左边结构相似。用 ① 除以 ②（假设 $x_1, x_2 \ne 0$）：

$$\frac{4\sigma x_1 (x_1^2 + x_2^2 - 1)}{4\sigma x_2 (x_1^2 + x_2^2 - 1)} = \frac{1}{1}$$

$$\frac{x_1}{x_2} = 1 \implies x_1 = x_2$$

将 $x_2 = x_1$ 代回方程 ①：

$$4\sigma x_1 (x_1^2 + x_1^2 - 1) = 1$$

$$4\sigma x_1 (2x_1^2 - 1) = 1$$

即：

$$8\sigma x_1^3 - 4\sigma x_1 - 1 = 0$$

## 第四步：令罚参数趋于无穷大

根据外罚函数法原理，当 $\sigma \rightarrow +\infty$ 时，方程中的 $1$ 相对于含 $\sigma$ 的项可以忽略（或者两边同除以 $\sigma$，得 $8x_1^3 - 4x_1 - \frac{1}{\sigma} = 0$，当 $\sigma \to \infty$ 时，$\frac{1}{\sigma} \to 0$）。

方程变为：

$$8x_1^3 - 4x_1 = 0$$

$$4x_1(2x_1^2 - 1) = 0$$

解得三个可能的根：

$$x_1 = 0, \quad x_1 = \frac{\sqrt{2}}{2}, \quad x_1 = -\frac{\sqrt{2}}{2}$$

### 第五步：确定最优解

我们需要使原目标函数 $f(x) = -x_1 - x_2 = -2x_1$ （因为 $x_1=x_2$）最小。

- 若 $x_1 = 0$，则 $f(x) = 0$。

- 若 $x_1 = -\frac{\sqrt{2}}{2}$，则 $f(x) = -2(-\frac{\sqrt{2}}{2}) = \sqrt{2} > 0$（这是最大值）。

- 若 $x_1 = \frac{\sqrt{2}}{2}$，则 $f(x) = -2(\frac{\sqrt{2}}{2}) = -\sqrt{2} < 0$（这是最小值）。


因此，最优解为 $x_1 = \frac{\sqrt{2}}{2}$。

对应的 $x_2 = \frac{\sqrt{2}}{2}$。

最小函数值为 $-\sqrt{2}$。

## 最终答案

填空处应填：

min f(x) = ( $-\sqrt{2}$ ) ; (x1,x2) = ( $\frac{\sqrt{2}}{2}, \frac{\sqrt{2}}{2}$ )

(注：如果需要填写小数，$-\sqrt{2} \approx -1.414$，坐标为 $(0.707, 0.707)$，通常这类数学题保留根号形式更准确)

---

**<font color="#2ecc71">✅ 已格式化</font>**
