![[Pasted image 20260106104138.png]]

这是一个标准的**线性最小二乘拟合**问题。

 虽然之前我们讨论的 Gauss-Newton 方法是用来解非线性问题的，但对于这种形式为 $y = a + bx$ 的简单线性模型，我们不需要迭代，直接套用最小二乘法的公式（也称为正规方程的解析解）就能算出精确答案。

### 1. 确定公式

对于线性模型 $y = a + bx$（注意这里 $a$ 是截距，$b$ 是斜率），参数的计算公式如下：

 - 斜率 $b$ 的公式：
     
     $$b = \frac{n\sum_{i=1}^{n} x_i y_i - (\sum_{i=1}^{n} x_i)(\sum_{i=1}^{n} y_i)}{n\sum_{i=1}^{n} x_i^2 - (\sum_{i=1}^{n} x_i)^2}$$
     
 - 截距 $a$ 的公式：
    
    $$a = \bar{y} - b\bar{x}$$
    
    其中 $\bar{x}$ 和 $\bar{y}$ 分别是 $x$ 和 $y$ 的平均值。
    

### 2. 计算统计量

已知数据点有 4 个 ($n=4$)：

- $x$: 1, 2, 3, 4
    
- $y$: 2, 5, 7, 11
    

我们需要计算以下求和项：

|**i**|**xi​**|**yi​**|**xi2​**|**xi​yi​**|
|---|---|---|---|---|
|1|1|2|1|2|
|2|2|5|4|10|
|3|3|7|9|21|
|4|4|11|16|44|
|**求和 ($\sum$)**|**10**|**25**|**30**|**77**|

- $\sum x_i = 10$
    
- $\sum y_i = 25$
    
- $\sum x_i^2 = 30$
    
- $\sum x_i y_i = 77$
    

以及平均值：

- $\bar{x} = 10 / 4 = 2.5$
    
- $\bar{y} = 25 / 4 = 6.25$
    

### 3. 代入公式计算

**第一步：计算 $b$ (斜率)**

$$b = \frac{4 \times 77 - 10 \times 25}{4 \times 30 - 10^2}$$

$$b = \frac{308 - 250}{120 - 100}$$

$$b = \frac{58}{20} = 2.9$$

**第二步：计算 $a$ (截距)**

$$a = 6.25 - 2.9 \times 2.5$$

$$a = 6.25 - 7.25$$

$$a = -1$$

### 4. 最终答案

$$a = -1, \quad b = 2.9$$

所以填空应为：

a = (-1) , b = (2.9)

拟合出的方程为：$y = -1 + 2.9x$。


## b 公式的由来
这是一个非常经典的问题。这个公式是通过**最小二乘法（Least Squares Method）**推导出来的。

简单来说，它的来源就是：**通过求导，找到让所有数据点的误差平方和最小的那个 $b$ 值**。

下面我为你一步步推导这个公式（只要你会一点点求导，就能完全看懂）：

### 1. 设定目标：让误差最小

假设我们有一组数据点 $(x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)$。

我们要找一条直线 $y = a + bx$ 来拟合它们。

对于每一个点 $x_i$，它的真实值是 $y_i$，而我们的预测值是 $a + bx_i$。

那么误差（残差）就是：

$$e_i = y_i - (a + bx_i)$$

我们要让所有点的**误差平方和（Loss Function）**最小：

$$Q = \sum_{i=1}^{n} (y_i - (a + bx_i))^2$$

### 2. 求导（寻找极值点）

为了让 $Q$ 最小，我们需要对未知数 $a$ 和 $b$ 分别求偏导数，并令导数为 0。

对 $a$ 求偏导：

$$\frac{\partial Q}{\partial a} = -2 \sum_{i=1}^{n} (y_i - a - bx_i) = 0$$

化简一下（去掉 -2）：

$$\sum y_i - \sum a - \sum bx_i = 0$$

因为 $\sum_{i=1}^n a = na$，所以得到 方程①：

$$\sum y_i = na + b\sum x_i \quad \text{------ (1)}$$

对 $b$ 求偏导：

$$\frac{\partial Q}{\partial b} = -2 \sum_{i=1}^{n} x_i(y_i - a - bx_i) = 0$$

化简一下（去掉 -2，把 $x_i$ 乘进去）：

$$\sum x_i y_i - a\sum x_i - b\sum x_i^2 = 0$$

得到 方程②：

$$\sum x_i y_i = a\sum x_i + b\sum x_i^2 \quad \text{------ (2)}$$

### 3. 解方程组（消元法）

现在我们有了两个关于 $a$ 和 $b$ 的方程（这叫**正规方程组**）：

1. $\sum y_i = na + b\sum x_i$
    
2. $\sum x_i y_i = a\sum x_i + b\sum x_i^2$
    

我们的目标是解出 $b$。为了消去 $a$，我们使用加减消元法：

- 给方程 (1) 两边同乘 $\sum x_i$：
    
    $$(\sum x_i)(\sum y_i) = n a \sum x_i + b (\sum x_i)^2 \quad \text{------ (3)}$$
    
- 给方程 (2) 两边同乘 $n$：
    
    $$n \sum x_i y_i = n a \sum x_i + n b \sum x_i^2 \quad \text{------ (4)}$$
    

现在，方程 (3) 和 (4) 中都有 $n a \sum x_i$ 这一项。我们用 **(4) 减去 (3)**：

$$n \sum x_i y_i - (\sum x_i)(\sum y_i) = (n b \sum x_i^2) - (b (\sum x_i)^2)$$

### 4. 提取公因式 b

把方程右边的 $b$ 提出来：

$$n \sum x_i y_i - (\sum x_i)(\sum y_i) = b \left[ n \sum x_i^2 - (\sum x_i)^2 \right]$$

### 5. 得到最终公式

最后，把括号里的项除过去，就得到了你图片里的公式：

$$b = \frac{n \sum_{i=1}^{n} x_i y_i - (\sum_{i=1}^{n} x_i)(\sum_{i=1}^{n} y_i)}{n \sum_{i=1}^{n} x_i^2 - (\sum_{i=1}^{n} x_i)^2}$$

---

### 💡 直观理解

这个公式其实在统计学上有更简洁的写法。如果你把分子分母都除以 $n^2$，它就变成了：

$$b = \frac{\text{Cov}(X, Y)}{\text{Var}(X)}$$

 即：$X$ 和 $Y$ 的协方差 除以 $X$ 的方差。
 
 - 分子表示 $X$ 和 $Y$ 一起变化的程度。
     
 - 分母表示 $X$ 自身变化的程度。
     
 - 这就衡量了：当 $X$ 变化时，$Y$ 平均对应变化多少（这正是斜率的定义）。
 
---

**<font color="#2ecc71">✅ 已格式化</font>**