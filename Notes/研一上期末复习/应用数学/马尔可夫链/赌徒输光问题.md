根据北京大学随机过程课件资料（特别是《第-2-章-第-2-讲_马尔可夫链 例子作业.pdf》和《第-2-章-第-5-讲马尔可夫链应用分析举例.pdf》），赌徒输光问题（Gambler's Ruin Problem）是一个经典的带有两个吸收壁的随机游走模型。

以下是该问题的详细解题方法及公式推导过程：

## 1. 问题建模

- 场景设定：赌徒甲有资本 $a$ 元，赌徒乙有资本 $b$ 元，总赌本 $c = a + b$。每局甲赢的概率为 $p$，输的概率为 $q = 1-p$。每局输者给赢者 1 元。直到一方输光（资本为 0）为止。
- 状态定义：设 $X_n$ 为第 $n$ 局后甲持有的资本。状态空间为 $I = \{0, 1, 2, \dots, c\}$。
- 吸收壁：
    - 状态 0：甲输光，游戏结束（吸收态）。
    - 状态 $c$：甲赢得所有钱（乙输光），游戏结束（吸收态）。
- 目标：求甲从初始资本 $i$（$0 \le i \le c$）出发，最终输光（即到达状态 0）的概率 $u_i$。

## 2. 建立差分方程

利用全概率公式建立递推关系。对于中间状态 $i$（$1 \le i \le c-1$），甲下一步只有两种可能：

1. 赢 1 元（转移到 $i+1$），概率为 $p$；
2. 输 1 元（转移到 $i-1$），概率为 $q$。

因此，当前状态 $i$ 输光的概率 $u_i$ 等于下一步各状态输光概率的加权和：

$$u_i = p u_{i+1} + q u_{i-1}, \quad i = 1, 2, \dots, c-1$$

边界条件：

- $u_0 = 1$（已经输光，概率为 1）
- $u_c = 0$（已经全赢，不可能输光，概率为 0）

## 3. 公式推导过程

为了求解上述差分方程，我们将方程变形：

由于 $p + q = 1$，我们可以将左边的 $u_i$ 写成 $(p+q)u_i$：

$$(p+q)u_i = p u_{i+1} + q u_{i-1}$$

移项整理得到：

$$p(u_{i+1} - u_i) = q(u_i - u_{i-1})$$

即：

$$u_{i+1} - u_i = \frac{q}{p} (u_i - u_{i-1})$$

令 $\Delta_i = u_i - u_{i-1}$，则 $\Delta_{i+1} = \frac{q}{p} \Delta_i$。这说明 $\{\Delta_i\}$ 是一个等比数列（几何级数），公比为 $r = q/p$。

根据递推关系：

$$\Delta_k = u_k - u_{k-1} = r^{k-1} \Delta_1 = r^{k-1} (u_1 - u_0)$$

由于 $u_0 = 1$，故 $\Delta_k = r^{k-1}(u_1 - 1)$。

我们可以将 $u_i$ 表示为累加形式：

$$u_i = u_0 + \sum_{k=1}^{i} \Delta_k = 1 + (u_1 - 1) \sum_{k=1}^{i} r^{k-1}$$

此时需要分两种情况讨论：

### 情况一：非公平赌博（$p \neq q$）

此时 $r = q/p \neq 1$。利用等比数列求和公式 $\sum_{k=1}^{i} r^{k-1} = \frac{1-r^i}{1-r}$，代入上式：

$$u_i = 1 + (u_1 - 1) \frac{1-r^i}{1-r}$$

利用边界条件 $u_c = 0$ 来确定未知的 $u_1$：

$$u_c = 1 + (u_1 - 1) \frac{1-r^c}{1-r} = 0$$

解得：

$$u_1 - 1 = -\frac{1-r}{1-r^c}$$

将 $(u_1 - 1)$ 代回 $u_i$ 的通式：

$$u_i = 1 - \frac{1-r}{1-r^c} \cdot \frac{1-r^i}{1-r} = 1 - \frac{1-r^i}{1-r^c} = \frac{(1-r^c) - (1-r^i)}{1-r^c} = \frac{r^i - r^c}{1 - r^c}$$

### 情况二：公平赌博（$p = q = 1/2$）

此时 $r = q/p = 1$。等比数列退化为常数数列，$\Delta_k = u_1 - 1$。

$$u_i = 1 + \sum_{k=1}^{i} (u_1 - 1) = 1 + i(u_1 - 1)$$

利用边界条件 $u_c = 0$：

$$1 + c(u_1 - 1) = 0 \implies u_1 - 1 = -\frac{1}{c}$$

代回 $u_i$ 通式：

$$u_i = 1 - \frac{i}{c} = \frac{c-i}{c}$$

## 4. 最终结论总结

设甲初始资本为 $a$，总资本为 $c$。

1. 当 $p \neq q$ 时（令 $r = q/p$）：
    甲输光的概率为：

    $$u_a = \frac{r^a - r^c}{1 - r^c} = \frac{(q/p)^a - (q/p)^c}{1 - (q/p)^c}$$

2. 当 $p = q = 1/2$ 时：
    甲输光的概率为：

    $$u_a = \frac{c - a}{c} = \frac{b}{a + b}$$

（即甲输光的概率等于乙的资金占总资金的比例）

## 5. 补充：乙输光（甲赢）的概率

记 $v_a$ 为甲最终赢得所有钱（到达状态 $c$）的概率，显然 $v_a = 1 - u_a$（因为迟早会进入吸收壁）。

- 若 $p=1/2$，甲赢的概率为 $a/c$。
- 若 $p \neq 1/2$，甲赢的概率为 $\frac{1 - (q/p)^a}{1 - (q/p)^c}$。

---

**<font color="#2ecc71">✅ 已格式化</font>**
