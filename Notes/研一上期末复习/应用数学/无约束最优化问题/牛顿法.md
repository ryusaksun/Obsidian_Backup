根据复习大纲和课件 `mac03.pdf`，第 3 章要求掌握算法框架。这三种方法都遵循"初始 -> 终止判断 -> 确定方向 -> 确定步长 -> 更新"的通用流程，主要的区别在于搜索方向的计算和步长的选取。

以下是三种方法的详细解题步骤：

## 1. 标准牛顿法

这是最基础的牛顿法，利用二阶导数（Hesse 矩阵）及其逆矩阵来确定方向，且步长固定为 1。

### 第 0 步：初始化

- 选取初始点 $x_0$。
- 设定终止误差 $\epsilon > 0$。
- 置 $k = 0$。

### 第 1 步：计算梯度与终止检验

- 计算梯度 $g_k = \nabla f(x_k)$。
- 若 $|g_k| \le \epsilon$，停止迭代，输出 $x_k$；否则继续。

### 第 2 步：确定搜索方向（牛顿方向）

- 计算 Hesse 矩阵 $G_k = \nabla^2 f(x_k)$。
- 求解线性方程组 $G_k d_k = -g_k$，得到方向 $d_k$（即 $d_k = -G_k^{-1}g_k$）。

### 第 3 步：确定步长

- 固定步长：令 $\alpha_k = 1$。

### 第 4 步：更新

- $x_{k+1} = x_k + d_k$。
- 令 $k = k+1$，转第 1 步。

特点：收敛速度快（二阶收敛），但要求 $G_k$ 正定且初始点必须离极小值点很近，否则可能不收敛。

---

## 2. 阻尼牛顿法

针对标准牛顿法步长为 1 可能导致函数值上升的问题，阻尼牛顿法引入了一维搜索（线搜索）来寻找合适的步长。

### 第 0 步：初始化

- 选取初始点 $x_0$，误差 $\epsilon$，线搜索参数（如 $\rho, \sigma$）。
- 置 $k = 0$。

### 第 1 步：计算梯度与终止检验

- 计算 $g_k = \nabla f(x_k)$。
- 若 $|g_k| \le \epsilon$，停止迭代。

### 第 2 步：确定搜索方向

- 计算 Hesse 矩阵 $G_k$。
- 求解 $G_k d_k = -g_k$ 得到方向 $d_k$。

### 第 3 步：确定步长（非精确搜索）

这是与标准牛顿法的核心区别。使用 Armijo 准则（或 Wolfe 准则）寻找步长 $\alpha_k$。

- 从 $\alpha = 1$ 开始尝试，若不满足下降条件 $f(x_k + \alpha d_k) \le f(x_k) + \sigma \alpha g_k^T d_k$，则缩小 $\alpha$（例如 $\alpha := 0.5\alpha$），直到满足为止。

### 第 4 步：更新

- $x_{k+1} = x_k + \alpha_k d_k$。
- 令 $k = k+1$，转第 1 步。

特点：具有全局收敛性，解决了标准牛顿法对初值敏感的问题。

---

## 3. 最速下降与牛顿混合法

也称为修正牛顿法。针对牛顿法中 $G_k$ 可能不正定（导致 $d_k$ 不是下降方向）或奇异（无法求逆）的问题，结合了最速下降法的稳定性。

### 第 0 步：初始化

- 选取初始点 $x_0$，误差 $\epsilon$。
- 置 $k = 0$。

### 第 1 步：计算梯度与终止检验

- 计算 $g_k$。若 $|g_k| \le \epsilon$，停止。

### 第 2 步：确定搜索方向（核心逻辑）

- 计算 Hesse 矩阵 $G_k$。
- 判断与选择：
    1. 尝试求解 $G_k d = -g_k$。
    2. 如果 $G_k$ 是正定的（或者满足下降条件 $g_k^T d < 0$），则取牛顿方向：$d_k = -G_k^{-1}g_k$。
    3. 否则（如果 $G_k$ 奇异或不是正定），强制使用最速下降方向：$d_k = -g_k$。

### 第 3 步：确定步长

- 使用线搜索方法（如 Armijo）确定步长 $\alpha_k$。

### 第 4 步：更新

- $x_{k+1} = x_k + \alpha_k d_k$。
- 令 $k = k+1$，转第 1 步。

特点：结合了牛顿法的快收敛速度（在极小值附近）和最速下降法的全局稳定性（在远离极小值时）。

## 总结对比

| 算法名称 | 搜索方向 $d_k$ | 步长 $\alpha_k$ | 备注 |
|:--|:--|:--|:--|
| 标准牛顿法 | $G_k d_k = -g_k$ | 固定为 1 | 收敛快但易失效 |
| 阻尼牛顿法 | $G_k d_k = -g_k$ | 线搜索确定 | 保证全局收敛 |
| 混合法 | 若 $G_k$ 正定用牛顿方向否则用 $-g_k$ | 线搜索确定 | 解决 $G_k$ 不正定问题 |

---

**<font color="#2ecc71">✅ 已格式化</font>**
