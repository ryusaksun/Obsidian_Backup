根据复习资料，Levenberg-Marquardt (L-M) 法是解决非线性最小二乘问题的核心算法。它结合了高斯-牛顿法和最速下降法的优点。

以下是基于资料中算法 7.1（全局收敛的 L-M 算法）及相关公式总结的解题步骤：

## 准备工作（建立模型）

将问题转化为非线性最小二乘标准形式：

$$ \min f(x) = \frac{1}{2}\|F(x)\|^2 = \frac{1}{2} \sum_{i=1}^{m} F_i^2(x) $$

其中 $x \in R^n$ 是待求参数，$F(x)$ 是误差向量函数。

你需要能够写出：

- 误差向量：$F(x)$
- Jacobi 矩阵：$J(x) = F'(x) = (\nabla F_1, \dots, \nabla F_m)^T$
- 梯度向量：$g(x) = J(x)^T F(x)$

## 算法迭代步骤

### 第一步：初始化

- 选取初始点 $x_0$。
- 设定参数：$\rho, \sigma \in (0,1)$（用于线搜索），初始阻尼因子 $\mu_0 > 0$（例如 $\mu_0 = 10^{-3}$ 或根据 $F(x_0)$ 的范数设定）。
- 设定终止误差 $\epsilon$。

### 第二步：计算当前点的导数信息

在当前点 $x_k$ 处，计算：

1. 函数值：$F_k = F(x_k)$
2. Jacobi 矩阵：$J_k = J(x_k)$
3. 梯度：$g_k = J_k^T F_k$

终止判断：如果 $\|g_k\| \le \epsilon$，则停止迭代，输出 $x_k$。

### 第三步：计算 L-M 方向（核心步骤）

求解以下线性方程组，得到搜索方向 $d_k$：

$$ (J_k^T J_k + \mu_k I) d_k = -g_k = -J_k^T F_k $$

注意：这是 L-M 法的关键。与高斯-牛顿法相比，这里增加了一个对角矩阵 $\mu_k I$。这使得系数矩阵 $J_k^T J_k + \mu_k I$ 始终是正定的（可逆的），避免了高斯-牛顿法中矩阵奇异的问题。

### 第四步：线搜索（确定步长）

虽然有些版本的 L-M 法直接取步长为 1，但资料中的算法 7.1 包含了一个 Armijo 线搜索过程以保证全局收敛性：

- 寻找最小的非负整数 $m_k$，使得步长 $\alpha_k = \rho^{m_k}$ 满足：

    $$ f(x_k + \alpha_k d_k) \le f(x_k) + \sigma \alpha_k g_k^T d_k $$

- 更新迭代点：$x_{k+1} = x_k + \alpha_k d_k$。

### 第五步：更新阻尼因子 $\mu_k$（调整策略）

计算实际下降量与预测下降量的比值 $\eta_k$：

$$ \eta_k = \frac{f(x_k) - f(x_{k+1})}{\Delta q_k(d_k)} $$

根据 $\eta_k$ 调整 $\mu_{k+1}$（参考资料中的策略）：

- 如果 $\eta_k$ 较大（如 > 0.75）：说明近似效果好，减小 $\mu$（接近高斯-牛顿法，加快收敛），例如 $\mu_{k+1} = 0.1 \mu_k$。
- 如果 $\eta_k$ 较小（如 < 0.25）：说明近似效果差，增大 $\mu$（接近最速下降法，保证下降），例如 $\mu_{k+1} = 10 \mu_k$。
- 否则：保持 $\mu$ 不变。

### 第六步：循环

令 $k = k+1$，返回第二步继续计算，直到满足终止条件。

## Matlab 实现参考

资料中提供了 L-M 法的 Matlab 代码示例，其核心逻辑与上述步骤一致：

```matlab
% 核心代码片段
gk = jfk' * fk;                 % 计算梯度
dk = -(jfk' * jfk + muk * eye(n)) \ gk; % 求解线性方程组
```

复习总结：

考试中如果遇到 L-M 法的题目，最重要的是写出修正后的法方程：$(J^T J + \mu I)d = -J^T F$。这是它区别于其他方法的标志性特征。

---

**<font color="#2ecc71">✅ 已格式化</font>**
