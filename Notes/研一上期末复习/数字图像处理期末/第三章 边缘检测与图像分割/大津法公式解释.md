大津法（Otsu's Method）的核心数学公式是类间方差（Between-class Variance）。为了让你彻底理解它，我们从"它是怎么来的"以及"它为什么长这样"两个角度来拆解。

## 1. 核心公式回顾

我们再看一眼这个简洁的公式：

$$\sigma_B^2 = \omega_0 \omega_1 (\mu_0 - \mu_1)^2$$

其中：

- $\sigma_B^2$：类间方差（我们要让它最大）。

- $\omega_0$：前景像素点占整张图的比例（比如 30% 是字，$\omega_0 = 0.3$）。

- $\omega_1$：背景像素点占整张图的比例（那么背景就是 70%，$\omega_1 = 0.7$）。

- $\mu_0$：前景像素的平均灰度值（比如字的平均灰度是 20）。

- $\mu_1$：背景像素的平均灰度值（比如白纸的平均灰度是 240）。

## 2. 为什么叫"类间方差"？它的物理意义是什么？

为了理解这个公式，我们先看一个直观的例子。

假设你要把一群人分成"高个子组"和"矮个子组"。

- 分得不好的情况：如果你的标准（阈值）选得不好，两组里都有高有矮。此时，两组的平均身高差距很小（比如一组平均 170cm，另一组平均 172cm）。

- 分得好的情况：如果你选的标准完美，矮个子全在一边（平均 160cm），高个子全在另一边（平均 180cm）。此时，两组平均值的差距 $(\mu_0 - \mu_1)$ 非常大。

大津法的公式 $\omega_0 \omega_1 (\mu_0 - \mu_1)^2$ 就是在衡量这种"区分度"：

- $(\mu_0 - \mu_1)^2$：代表两组平均值的距离。这是核心驱动力，两组分得越开，这个值越大。

- $\omega_0 \omega_1$：这是一个权重系数，它保证了分割的稳定性。它倾向于让两组的像素数量尽量均衡，避免出现"一组只有 1 个像素，另一组有 10000 个像素"这种极端情况（虽然此时均值差可能很大，但没意义）。

## 3. 这个公式是怎么推导出来的？（进阶理解）

其实，大津法最原始的出发点是统计学中的方差分解定理：

$$\text{总方差} (\sigma_T^2) = \text{类内方差} (\sigma_W^2) + \text{类间方差} (\sigma_B^2)$$

- 总方差 $\sigma_T^2$：整张图所有像素的方差。对于一张固定的图，这个值是固定不变的。

- 类内方差 $\sigma_W^2$：前景内部的方差 + 背景内部的方差。

    - 我们希望分出来的每一类都"很纯"，比如前景全是黑的，背景全是白的。所以我们希望类内方差越小越好。

- 类间方差 $\sigma_B^2$：前景和背景之间的差异。

    - 因为 总方差 = 类内 + 类间，且总方差固定。

    - 所以：让类内方差最小 $\Leftrightarrow$ 让类间方差最大。

原本计算"类内方差"比较麻烦（要算每个像素偏离均值的平方和）。大津展之（Nobuyuki Otsu）推导出了一个等价的、极其简单的计算"类间方差"的公式，也就是我们现在用的这个：

$$\sigma_B^2 = \omega_0 \omega_1 (\mu_0 - \mu_1)^2$$

## 总结

这个公式巧妙地用"两组的平均值差"代替了复杂的方差计算。它告诉计算机："不用管每一组内部有多乱，你只要保证分出来的这两组，平均看起来差别最大，那就是最好的一刀。"

---

**<font color="#2ecc71">✅ 已格式化</font>**
